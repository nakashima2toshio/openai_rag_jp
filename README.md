# ğŸš€ RAG(Cloud & local-Qdrant)From Scratch with Streamlit
## ã‚¹ã‚¯ãƒ©ãƒƒãƒã§ã€RAGæ§‹ç¯‰ï¼ˆã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆï¼†ãƒ­ãƒ¼ã‚«ãƒ«-Qdrantç‰ˆï¼‰
- If you prefer English, please use translation tools like Google Translate to read the English version.
## ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

è©³ç´°ãªä½¿ç”¨æ–¹æ³•ã¨ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«ã¤ã„ã¦ã¯ï¼š
- [README_2.md](./README_2.md) - ç›®çš„åˆ¥ã®è©³ç´°ãªä½¿ç”¨ä¾‹
- [README_preparation.md](./README_preparation.md) - é–‹ç™ºç’°å¢ƒã®è©³ç´°è¨­å®š
- [README_qdrant.md](./README_qdrant.md) - Qdrantãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆã®è©³ç´°
- [README_qdrant_setup.md](./README_qdrant_setup.md) - Qdranté«˜åº¦ãªè¨­å®š

## ğŸ”— é–¢é€£ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ## ğŸ”— é–¢é€£ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ


| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ                                                             | èª¬æ˜                                         | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
| ------------------------------------------------------------------------ | -------------------------------------------- | ---------- |
| [openai_api_jp](https://github.com/nakashima2toshio/openai_api_jp)       | OpenAI APIå®Œå…¨ã‚¬ã‚¤ãƒ‰ï¼ˆæœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰       | âœ… å…¬é–‹ä¸­  |
| [anthropic_api_jp](https://github.com/nakashima2toshio/anthropic_api_jp) | Anthropic Claude APIæ´»ç”¨                     | âœ… å…¬é–‹ä¸­  |
| [openai_rag_jp](https://github.com/nakashima2toshio/openai_rag_jp)       | RAGå®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³é›†ï¼ˆcloudç‰ˆã€Local-Qdrantç‰ˆï¼‰ | âœ… å…¬é–‹ä¸­  |
| [openai_mcp_jp](https://github.com/nakashima2toshio/openai_mcp_jp)       | MCP(Model Context Protocol)å®Ÿè£…              | ğŸš§ æ•´å‚™ä¸­  |
| [openai_django_jp](https://github.com/nakashima2toshio/openai_django_jp) | OpenAI API + Djangoå®Ÿè£…                      | âœ… å…¬é–‹ä¸­  |
| [openai_agent_jp](https://github.com/nakashima2toshio/openai_agent_jp)   | AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ§‹ç¯‰                           | ğŸ“ ä½œæˆä¸­  |

## ğŸ“Œ æ¦‚è¦

æ—¥æœ¬èªå¯¾å¿œã®RAGï¼ˆRetrieval-Augmented Generationï¼‰ã‚·ã‚¹ãƒ†ãƒ ã®å®Œå…¨å®Ÿè£…ç‰ˆã€‚OpenAI APIã¨Qdrantãƒ™ã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆã¨ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆã®ä¸¡æ–¹ã®RAGã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚

### ğŸ¯ ä¸»ãªç‰¹å¾´

- **ãƒ‡ãƒ¥ã‚¢ãƒ«ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ**: OpenAI Vector Storeï¼ˆã‚¯ãƒ©ã‚¦ãƒ‰ï¼‰ã¨Qdrantï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰ã®ä¸¡æ–¹ã‚’ã‚µãƒãƒ¼ãƒˆ
- **ãƒãƒ«ãƒãƒ‰ãƒ¡ã‚¤ãƒ³å¯¾å¿œ**: ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆã€åŒ»ç™‚ã€ç§‘å­¦æŠ€è¡“ã€æ³•å¾‹ã®4ã¤ã®å°‚é–€åˆ†é‡
- **æ—¥æœ¬èªå®Œå…¨å¯¾å¿œ**: æ—¥æœ¬èªã§ã®è³ªå•å¿œç­”ã¨æ¤œç´¢ã«æœ€é©åŒ–
- **ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³å¯¾å¿œ**: DockeråŒ–ã€ç›£è¦–ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ©Ÿèƒ½ã‚’å®Œå‚™
- **æœ€æ–°ãƒ¢ãƒ‡ãƒ«å¯¾å¿œ**: GPT-4oã€o1-o4ã‚·ãƒªãƒ¼ã‚ºã®æœ€æ–°AIãƒ¢ãƒ‡ãƒ«ã‚’ã‚µãƒãƒ¼ãƒˆ

# RAG å·¥ç¨‹ãƒãƒƒãƒ—ï¼ˆCloud / Local å¯¾å¿œè¡¨ï¼‰

æœ¬æ›¸ã¯ã€ãƒªãƒã‚¸ãƒˆãƒªå†…ã®å„ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒ **RAG å·¥ç¨‹ï¼ˆ1ã€œ7ï¼‰** ã® **ã©ã“ã‚’ã€ã©ã†æ‹…å½“ã—ã¦ã„ã‚‹ã‹** ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ã¦æ•´ç†ã—ãŸã‚‚ã®ã§ã™ã€‚
ã¾ãšå·¥ç¨‹ã®å‡¡ä¾‹ã€ã¤ã¥ã„ã¦ **(1) Cloud ç‰ˆï¼ˆVector Storeï¼‰**ã€**(2) Local ç‰ˆï¼ˆQdrantï¼‰**ã€æœ€å¾Œã« **å…±é€šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«** ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚

## å·¥ç¨‹ã®å‡¡ä¾‹

| ç•ªå· | å·¥ç¨‹å | ä¸»ãªå†…å®¹ |
|---|---|---|
| 1 | å‰å‡¦ç† | æ–‡å­—ã‚³ãƒ¼ãƒ‰/æ”¹è¡Œ/ç©ºç™½/é‡è¤‡ã®æ•´å½¢ã€ãƒã‚¤ã‚ºé™¤å»ï¼ˆãƒŠãƒ“/ãƒ•ãƒƒã‚¿ãƒ¼ç­‰ï¼‰ã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºï¼ˆã‚¿ã‚¤ãƒˆãƒ«/URL/ã‚»ã‚¯ã‚·ãƒ§ãƒ³/æ›´æ–°æ—¥ï¼‰ |
| 2 | ãƒãƒ£ãƒ³ã‚¯åˆ†å‰² | å›ºå®šé•· or æ„å‘³å˜ä½ã€‚ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—ï¼ˆ10â€“20%ï¼‰ã€‚æ—¥æœ¬èªã¯æ–‡å­—æ•°åŸºæº–ï¼ˆ800â€“1,200å­—ï¼‹100â€“200é‡ãªã‚Šï¼‰æ¨å¥¨ã€‚ã‚³ãƒ¼ãƒ‰/è¡¨ã¯ç‹¬ç«‹ãƒãƒ£ãƒ³ã‚¯ |
| 3 | ãƒ™ã‚¯ãƒˆãƒ«åŒ– | å„ãƒãƒ£ãƒ³ã‚¯ã‚’åŸ‹ã‚è¾¼ã¿ã€‚å¿…è¦ã«å¿œã˜ **L2 æ­£è¦åŒ–**ï¼ˆCosine é¡ä¼¼åº¦æ™‚ï¼‰ |
| 4 | ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åŒ– | ãƒ™ã‚¯ã‚¿DBã¸æ ¼ç´ï¼ˆè¿‘ä¼¼æœ€è¿‘å‚ï¼‰ã€‚æœ¬æ–‡ãƒ»ãƒ¡ã‚¿ãƒ»chunk_id ã‚’ä¿å­˜ã€‚å±æ€§ãƒ•ã‚£ãƒ«ã‚¿ç”¨ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åŒ– |
| 5 | æ¤œç´¢ï¼ˆã‚¯ã‚¨ãƒªå´ï¼‰ | ã‚¯ã‚¨ãƒªã‚‚åŒã˜ãƒ¢ãƒ‡ãƒ«ã§åŸ‹ã‚è¾¼ã¿ã€‚ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ï¼‹ï¼ˆä»»æ„ã§ï¼‰BM25ã€MMRã€ãƒ•ã‚£ãƒ«ã‚¿ã€æ™‚é–“æ¸›è¡°ã€å†ãƒ©ãƒ³ã‚­ãƒ³ã‚° |
| 6 | ç”Ÿæˆ | é¸æŠœãƒãƒ£ãƒ³ã‚¯ã‚’çµåˆï¼ˆé‡è¤‡/åŒä¸€å‡ºå…¸ã®çµ±åˆï¼‰ã€‚å‡ºå…¸ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä»˜ä¸ |
| 7 | ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°/è©•ä¾¡ | ãƒ’ãƒƒãƒˆç‡ãƒ»æ­£ç¢ºæ€§ã®è©•ä¾¡ã€ãƒãƒ£ãƒ³ã‚¯é•·/ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—/ãƒ¢ãƒ‡ãƒ«/é–¾å€¤ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚° |

---

# (1) Cloud ç‰ˆï¼ˆOpenAI Vector Store ã‚’ä½¿ã†ï¼‰

## ãƒ•ã‚¡ã‚¤ãƒ«åˆ¥ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆCloudï¼‰

| ãƒ—ãƒ­ã‚°ãƒ©ãƒ  | RAG å·¥ç¨‹ï¼ˆã©ã“ï¼‰ | ã©ã†å¯¾å¿œã—ã¦ã„ã‚‹ã‹ | å…¥åŠ› â†’ å‡ºåŠ› | å‚™è€ƒ |
|---|---|---|---|---|
| `a01_load_set_rag_data.py` | **1 å‰å‡¦ç†**ï¼‹**2 ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²** | æ­£è¦åŒ–ï¼ãƒã‚¤ã‚ºé™¤å»ï¼ãƒ¡ã‚¿æŠ½å‡º â†’ æ–‡å­—æ•°åŸºæº–ï¼‹ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—ã§åˆ†å‰² | åŸæ–‡, `config_yml.yml` â†’ `OUTPUT/processed/*.jsonl`ï¼ˆ`{text, meta, chunk_id}`ï¼‰ | Cloud/Local å…±ç”¨ã®å‰æ®µ |
| `a02_set_vector_store_vsid.py` | **3 ãƒ™ã‚¯ãƒˆãƒ«åŒ–**ï¼‹**4 ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åŒ–ï¼ˆCloudï¼‰** | Vector Store ä½œæˆ/å–å¾—ï¼ˆVSIDï¼‰â†’ a01 å‡ºåŠ›ã‚’æŠ•å…¥ã€‚VS å´ã§åŸ‹ã‚è¾¼ã¿ç”Ÿæˆï¼†ç´¢å¼•åŒ–ã€‚æœ¬æ–‡ãƒ»ãƒ¡ã‚¿ãƒ»chunk_id ã‚’æ ¼ç´ | `OUTPUT/processed/*.jsonl` â†’ Vector Storeï¼ˆVSID/ãƒ•ã‚¡ã‚¤ãƒ«IDï¼‰ | L2 æ­£è¦åŒ–ã¯ VS ã®é¡ä¼¼åº¦è¨­å®šã«å¾“ã†ï¼ˆå¿…è¦ã«å¿œã˜ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§å®Ÿæ–½ï¼‰ |
| `a20_rag_search_cloud_vs.py` | **5 æ¤œç´¢**ï¼‹**6 ç”Ÿæˆ** | ã‚¯ã‚¨ãƒªåŸ‹ã‚è¾¼ã¿ â†’ VS é¡ä¼¼æ¤œç´¢ â†’ï¼ˆä»»æ„ï¼‰MMR/ãƒ•ã‚£ãƒ«ã‚¿/æ™‚é–“æ¸›è¡° â†’ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆçµåˆ â†’ å‡ºå…¸ä»˜ä¸ã—ã¦å¿œç­” | `query`, VSID â†’ å›ç­”ãƒ†ã‚­ã‚¹ãƒˆï¼‹å‡ºå…¸ | Top-k/ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ/ãƒ¢ãƒ‡ãƒ«ã¯ `config_yml.yml` ã§åˆ¶å¾¡ |
| `server.py` | **5 æ¤œç´¢**ï¼‹**6 ç”Ÿæˆ**ï¼ˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰ | `a20` ã®å‡¦ç†ã‚’ API/ã‚µãƒ¼ãƒã¨ã—ã¦å…¬é–‹ï¼ˆå•ã„åˆã‚ã›â†’æ¤œç´¢â†’çµ„ç«‹â†’å¿œç­”ï¼‰ | HTTP/CLI â†’ JSON/ãƒ†ã‚­ã‚¹ãƒˆå¿œç­” | é‹ç”¨æ™‚ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ |
| `setup.py` | 0 ç’°å¢ƒåœŸå° | ä¾å­˜å°å…¥ãƒ»CLI ã‚¨ãƒ³ãƒˆãƒªã€‚RAG ãƒ­ã‚¸ãƒƒã‚¯ã¯æŒãŸãªã„ | - | - |
| `docker-compose/docker-compose.yml` | ï¼ˆCloud ã§ã¯é€šå¸¸æœªä½¿ç”¨ï¼‰ | Qdrant ã‚’ä½¿ã‚ãªã„ãŸã‚ä¸è¦ | - | Local ã§ä½¿ç”¨ |

> Cloud ç‰ˆã§ã¯ã€`a10_show_qdrant_data.py` / `a50_qdrant_registration.py` / `a50_rag_search_local_qdrant.py` ã¯å¯¾è±¡å¤–ã§ã™ï¼ˆQdrant ç”¨ï¼‰ã€‚

---

# (2) Local ç‰ˆï¼ˆQdrant ã‚’ä½¿ã†ï¼‰

## ãƒ•ã‚¡ã‚¤ãƒ«åˆ¥ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆLocalï¼‰

| ãƒ—ãƒ­ã‚°ãƒ©ãƒ  | RAG å·¥ç¨‹ï¼ˆã©ã“ï¼‰ | ã©ã†å¯¾å¿œã—ã¦ã„ã‚‹ã‹ | å…¥åŠ› â†’ å‡ºåŠ› | å‚™è€ƒ |
|---|---|---|---|---|
| `docker-compose/docker-compose.yml` | **4/5 ã®ã€Œå™¨ã€** | Qdrant ã®èµ·å‹•ãƒ»æ°¸ç¶šåŒ–ãƒ»ãƒãƒ¼ãƒˆã‚’å®šç¾©ï¼ˆHNSW å®Ÿä½“ã¯ Qdrant å†…ï¼‰ | compose è¨­å®š â†’ Qdrant ãƒ©ãƒ³ã‚¿ã‚¤ãƒ  | `docker compose up -d` |
| `a01_load_set_rag_data.py` | **1 å‰å‡¦ç†**ï¼‹**2 ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²** | æ­£è¦åŒ–ï¼ãƒ¡ã‚¿æŠ½å‡º â†’ æ–‡å­—æ•°åŸºæº–ï¼‹ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—åˆ†å‰² | åŸæ–‡, `config_yml.yml` â†’ `OUTPUT/processed/*.jsonl` | Cloud ã¨å…±é€šã®å‰æ®µ |
| `a50_qdrant_registration.py` | **3 ãƒ™ã‚¯ãƒˆãƒ«åŒ–**ï¼‹**4 ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åŒ–ï¼ˆLocalï¼‰** | å„ãƒãƒ£ãƒ³ã‚¯ã‚’åŸ‹ã‚è¾¼ã¿ â†’ï¼ˆCosine é‹ç”¨ãªã‚‰ **L2 æ­£è¦åŒ–**ï¼‰â†’ Qdrant ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ä½œæˆï¼ˆ`m`, `ef_construct`ï¼‰â†’ upsertï¼ˆæœ¬æ–‡ãƒ»ãƒ¡ã‚¿ãƒ»`chunk_id` ã‚’ payloadï¼‰ | `OUTPUT/processed/*.jsonl` â†’ Qdrant ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ | `distance=Cosine` ã‚’æ¨å¥¨ï¼ˆã¾ãŸã¯ L2 æ­£è¦åŒ–ã‚’å¾¹åº•ï¼‰ |
| `a10_show_qdrant_data.py` | **4 ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ¤œè¨¼** | ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ä¸€è¦§/ä»¶æ•°/ã‚¹ã‚­ãƒ¼ãƒ/ä»»æ„ãƒã‚¤ãƒ³ãƒˆã® payload ã‚’å¯è¦–åŒ– | Qdrant â†’ è¡¨ç¤º/ãƒ­ã‚° | ç™»éŒ²å“è³ªã®ç‚¹æ¤œç”¨ |
| `a50_rag_search_local_qdrant.py` | **5 æ¤œç´¢**ï¼‹**6 ç”Ÿæˆ** | ã‚¯ã‚¨ãƒªåŸ‹ã‚è¾¼ã¿ â†’ Qdrant æ¤œç´¢ï¼ˆ`top_k`,`ef`ï¼‰ï¼‹ãƒ¡ã‚¿ãƒ•ã‚£ãƒ«ã‚¿ â†’ï¼ˆä»»æ„ï¼‰MMR/å†ãƒ©ãƒ³ã‚¯ â†’ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆçµåˆ â†’ å‡ºå…¸ä»˜ä¸ | `query`, Qdrant â†’ å›ç­”ãƒ†ã‚­ã‚¹ãƒˆï¼‹å‡ºå…¸ | æ¤œç´¢ãƒ‘ãƒ©ãƒ¡ã‚¿ã¯ `config_yml.yml` |
| `server.py` | **5 æ¤œç´¢**ï¼‹**6 ç”Ÿæˆ**ï¼ˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰ | `a50_rag_search_local_qdrant.py` ã®å‡¦ç†ã‚’ API/ã‚µãƒ¼ãƒã¨ã—ã¦å…¬é–‹ | HTTP/CLI â†’ JSON/ãƒ†ã‚­ã‚¹ãƒˆå¿œç­” | é‹ç”¨æ™‚ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ |
| `setup.py` | 0 ç’°å¢ƒåœŸå° | ä¾å­˜å°å…¥ãƒ»CLI ã‚¨ãƒ³ãƒˆãƒªã€‚RAG ãƒ­ã‚¸ãƒƒã‚¯ã¯æŒãŸãªã„ | - | - |

> Local ç‰ˆã§ã¯ã€`a02_set_vector_store_vsid.py` / `a20_rag_search_cloud_vs.py` ã¯å¯¾è±¡å¤–ã§ã™ï¼ˆCloud å°‚ç”¨ï¼‰ã€‚

---

# å…±é€šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆCloud / Local ä¸¡å¯¾å¿œï¼‰

## å…±é€šãƒ†ãƒ¼ãƒ–ãƒ«

| ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« | é–¢ä¸å·¥ç¨‹ | ã©ã†æ”¯ãˆã‚‹ã‹ | ä¸»ãªã‚­ãƒ¼/é–¢æ•°ã®ä¾‹ |
|---|---|---|---|
| `config_yml.yml` | **1ã€œ6** | å‰å‡¦ç†/åˆ†å‰²/åŸ‹ã‚è¾¼ã¿/æ¤œç´¢/ç”Ÿæˆã®ä¸€å…ƒè¨­å®š | `preprocess.*`, `chunk.size/overlap`, **Cloud**: `cloud.vector_store.*`, `cloud.embedding.model`, `cloud.search.*`, `cloud.generation.*` / **Local**: `qdrant.*`, `embedding.model`, `hnsw.*`, `search.top_k/ef`, `prompt.template` |
| `helper_api.py` | **3ã€œ6 å‘¨è¾º** | OpenAI/Anthropic/Qdrant ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€ãƒ¬ãƒ¼ãƒˆåˆ¶å¾¡ã€ãƒªãƒˆãƒ©ã‚¤ã€ãƒ­ã‚° | `get_openai_client()`, `get_qdrant_client()`, `retry_request()` |
| `helper_rag.py` | **1ã€œ6 ã‚³ã‚¢** | å‰å‡¦ç†ãƒ»åˆ†å‰²ãƒ»ãƒ¡ã‚¿ç”Ÿæˆãƒ»åŸ‹ã‚è¾¼ã¿ãƒ»MMRãƒ»L2 æ­£è¦åŒ–ãƒ»ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ•´å½¢ãƒ»å‡ºå…¸æ•´å½¢ | `clean_text()`, `chunk_text()`, `build_metadata()`, `embed_texts()`, `l2_normalize()`, `mmr()`, `build_context()` |
| `helper_st.py` | **5ã€œ6 å¯è¦–åŒ–** | æ¤œç´¢çµæœãƒ»ã‚¹ã‚³ã‚¢ãƒ»å‡ºå…¸ã® UIã€è¨­å®šãƒ‘ãƒãƒ«ã€ãƒ‡ãƒãƒƒã‚°ãƒ“ãƒ¥ãƒ¼ | `render_search_results()`, `render_config_panel()` |

---

## æœ€çŸ­å®Ÿè¡Œãƒ•ãƒ­ãƒ¼ï¼ˆå‚è€ƒï¼‰

### Cloudï¼ˆVector Storeï¼‰
1. `a01_load_set_rag_data.py`ï¼š**1 å‰å‡¦ç†ï¼‹2 åˆ†å‰²**
2. `a02_set_vector_store_vsid.py`ï¼š**3 ãƒ™ã‚¯ãƒˆãƒ«åŒ–ï¼‹4 ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åŒ–ï¼ˆCloudï¼‰**
3. `a20_rag_search_cloud_vs.py`ï¼ˆor `server.py`ï¼‰ï¼š**5 æ¤œç´¢ï¼‹6 ç”Ÿæˆ**

### Localï¼ˆQdrantï¼‰
1. `a01_load_set_rag_data.py`ï¼š**1 å‰å‡¦ç†ï¼‹2 åˆ†å‰²**
2. `docker compose up -d`ï¼š**Qdrant èµ·å‹•**
3. `a50_qdrant_registration.py`ï¼š**3 ãƒ™ã‚¯ãƒˆãƒ«åŒ–ï¼‹4 ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åŒ–ï¼ˆLocalï¼‰**
4. `a50_rag_search_local_qdrant.py`ï¼ˆor `server.py`ï¼‰ï¼š**5 æ¤œç´¢ï¼‹6 ç”Ÿæˆ**
5. å¿…è¦ã«å¿œã˜ã¦ `a10_show_qdrant_data.py`ï¼š**4 æ¤œè¨¼**

---

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ï¼ˆè¦ç‚¹ã ã‘ï¼‰

- **æ—¥æœ¬èªãƒãƒ£ãƒ³ã‚¯**ï¼šé–‹å§‹ã¯ **800â€“1,200 æ–‡å­—**ï¼‹**100â€“200 é‡ãªã‚Š**ã€‚
- **æ­£è¦åŒ–ã®ä¸€è²«æ€§**ï¼šå‰å‡¦ç†ï¼ˆæœ¬æ–‡ï¼‰ã¨ã‚¯ã‚¨ãƒªå´ã§åŒã˜æ­£è¦åŒ–ãƒãƒªã‚·ãƒ¼ï¼ˆå…¨è§’/åŠè§’ã€å¥èª­ç‚¹ã€ç©ºç™½ï¼‰ã€‚
- **Cosine é‹ç”¨**ï¼šQdrant ã¯ `distance=Cosine` ã¾ãŸã¯ **L2 æ­£è¦åŒ–**ã‚’ä¸€è²«ã€‚
- **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿**ï¼š`source, title, section, lang, domain, timestamp` ã‚’ä¿å­˜ï¼ˆãƒ•ã‚£ãƒ«ã‚¿/å‡ºå…¸è¡¨ç¤ºã«æ´»ç”¨ï¼‰ã€‚
- **MMR/å†ãƒ©ãƒ³ã‚¯**ï¼šTop-k ã®å¤šæ§˜æ€§ãƒ»ç²¾åº¦ã‚’ä¸Šã’ã‚‹ã€‚å¿…è¦ã«å¿œã˜ã‚¯ãƒ­ã‚¹ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€å°å…¥ã€‚
- **è©•ä¾¡ãƒ­ã‚°ï¼ˆå·¥ç¨‹7ï¼‰**ï¼šã‚¯ã‚¨ãƒªâ†’å‘½ä¸­ãƒãƒ£ãƒ³ã‚¯â†’æ¡ç‚¹ã‚’ `logs/` ã«æ®‹ã—ã€`chunk.size/overlap/top_k/MMR Î»` ã‚’ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã€‚

---

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```mermaid
graph TB
    subgraph "Data Sources"
        HF[HuggingFace Datasets]
    end
    
    subgraph "Data Processing"
        DL[Dataset Downloader]
        PP[Preprocessing Pipeline]
    end
    
    subgraph "Vector Storage"
        direction TB
        Cloud[OpenAI Vector Store<br/>ã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆ]
        Local[Qdrant Vector DB<br/>ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆ]
    end
    
    subgraph "Search Interface"
        UI[Streamlit Web UI]
        API[RAG Search API]
    end
    
    HF --> DL
    DL --> PP
    PP --> Cloud
    PP --> Local
    Cloud --> API
    Local --> API
    API --> UI
```

## ğŸ“¦ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### ğŸ”§ ç’°å¢ƒæº–å‚™

```bash
# 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³
git clone <repository-url>
cd openai_rag_jp

# 2. Pythonä»®æƒ³ç’°å¢ƒã®ä½œæˆ
python -m venv venv
source venv/bin/activate  # macOS/Linux
# venv\Scripts\activate   # Windows

# 3. ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt

# 4. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
echo "OPENAI_API_KEY=sk-your-api-key" > .env
```

è©³ç´°ãªç’°å¢ƒæº–å‚™æ‰‹é †ã¯ [ğŸ“š README_preparation.md](./README_preparation.md) ã‚’å‚ç…§

### ğŸ³ Dockerç’°å¢ƒã®èµ·å‹•ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆã®ã¿ï¼‰

```bash
# Docker Composeã§ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•
cd docker-compose/
docker-compose -f docker-compose.yml up -d

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«æˆ»ã‚‹
cd ..
```

### âš¡ è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ç’°å¢ƒã®è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
python setup.py

# çµ±åˆã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•
python server.py
```

## ğŸ”„ RAGæ§‹ç¯‰ãƒ•ãƒ­ãƒ¼

### ğŸ“Š Step 1: çµ±åˆãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ„ãƒ¼ãƒ«

**ğŸ†• çµ±åˆRAGãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ„ãƒ¼ãƒ«ï¼ˆStreamlit UIï¼‰:**
```bash
# çµ±åˆRAGãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ„ãƒ¼ãƒ«ã‚’èµ·å‹•
streamlit run a01_load_set_rag_data.py --server.port=8501
```

çµ±åˆãƒ„ãƒ¼ãƒ«ã®ç‰¹å¾´ï¼š
- âœ… 4ç¨®é¡ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’å˜ä¸€UIã§å‡¦ç†
- âœ… HuggingFaceã‹ã‚‰ç›´æ¥ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼†å‡¦ç†
- âœ… ãƒ‡ãƒ¼ã‚¿å“è³ªãƒã‚§ãƒƒã‚¯ã¨æ¤œè¨¼æ©Ÿèƒ½
- âœ… ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡ã®äº‹å‰æ¨å®š
- âœ… CSV/TXT/JSONå½¢å¼ã§ã®å‡ºåŠ›
- âœ… ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•ä¿å­˜

å¯¾å¿œãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆHuggingFaceã‹ã‚‰æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼‰ï¼š
- ğŸ“ ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆFAQ
- ğŸ¥ åŒ»ç™‚Q&Aï¼ˆæ¨è«–éç¨‹ä»˜ãï¼‰
- ğŸ”¬ ç§‘å­¦æŠ€è¡“Q&Aï¼ˆé¸æŠè‚¢ä»˜ãï¼‰
- âš–ï¸ æ³•å¾‹Q&A

### ğŸ’¾ Step 2: ãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ã¸ã®ç™»éŒ²

#### â˜ï¸ ã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆï¼ˆOpenAI Vector Storeï¼‰

```bash
# OpenAI Vector Storeã®ä½œæˆ
python a02_make_vsid.py
```

#### ğŸ  ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆï¼ˆQdrantï¼‰

```bash
# Qdrantã¸ã®ãƒ‡ãƒ¼ã‚¿ç™»éŒ²ï¼ˆè©³ç´°ç‰ˆï¼‰
python a50_qdrant_registration.py --recreate --include-answer

# ã¾ãŸã¯ç°¡æ˜“ç‰ˆï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰
python qdrant_data_loader.py --recreate --limit 100
```

### ğŸ” Step 4: RAGæ¤œç´¢ã®å®Ÿè¡Œ

#### â˜ï¸ ã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆæ¤œç´¢

```bash
# Streamlit UIã§æ¤œç´¢ï¼ˆOpenAI Vector Storeä½¿ç”¨ï¼‰
streamlit run a03_rag_search.py
```

#### ğŸ  ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆæ¤œç´¢

```bash
# Streamlit UIã§æ¤œç´¢ï¼ˆQdrantä½¿ç”¨ï¼‰
streamlit run a50_qdrant_search.py
```

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
openai_rag_jp/
â”œâ”€â”€ ğŸ“‹ READMEé–¢é€£
â”‚   â”œâ”€â”€ README.md                    # æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ README_2.md                  # åˆ©ç”¨æ‰‹é †ã¨ç›®çš„åˆ¥ã‚µãƒ³ãƒ—ãƒ«
â”‚   â”œâ”€â”€ README_preparation.md        # é–‹ç™ºç’°å¢ƒã®æº–å‚™
â”‚   â”œâ”€â”€ README_qdrant.md            # Qdrantãƒ­ãƒ¼ã‚«ãƒ«ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
â”‚   â””â”€â”€ README_qdrant_setup.md      # Qdrantè©³ç´°è¨­å®š
â”‚
â”œâ”€â”€ ğŸ”§ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ»ã‚µãƒ¼ãƒãƒ¼
â”‚   â”œâ”€â”€ setup.py                     # ç’°å¢ƒè‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
â”‚   â”œâ”€â”€ server.py                    # çµ±åˆã‚µãƒ¼ãƒãƒ¼ç®¡ç†
â”‚   â””â”€â”€ docker-compose/              # Dockerè¨­å®š
â”‚       â””â”€â”€ docker-compose.yml
â”‚
â”œâ”€â”€ ğŸ“¥ ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»å‡¦ç†
â”‚   â””â”€â”€ a01_load_set_rag_data.py    # çµ±åˆRAGãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ„ãƒ¼ãƒ«ï¼ˆHuggingFaceã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼†å‡¦ç†ï¼‰
â”‚
â”œâ”€â”€ â˜ï¸ ã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆRAG
â”‚   â”œâ”€â”€ a02_make_vsid.py             # OpenAI Vector Storeä½œæˆ
â”‚   â””â”€â”€ a03_rag_search.py            # ã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆRAGæ¤œç´¢
â”‚
â”œâ”€â”€ ğŸ  ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆRAG
â”‚   â”œâ”€â”€ a50_qdrant_registration.py   # Qdrantãƒ‡ãƒ¼ã‚¿ç™»éŒ²
â”‚   â”œâ”€â”€ a50_qdrant_search.py        # Qdrant RAGæ¤œç´¢
â”‚   â”œâ”€â”€ a10_show_qdrant_data.py     # Qdrantãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
â”‚   â””â”€â”€ qdrant_data_loader.py       # ç°¡æ˜“ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼
â”‚
â”œâ”€â”€ ğŸ› ï¸ ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”œâ”€â”€ helper_api.py                # OpenAI APIãƒ©ãƒƒãƒ‘ãƒ¼
â”‚   â”œâ”€â”€ helper_rag.py                # RAGå‡¦ç†ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â””â”€â”€ helper_st.py                 # Streamlitãƒ˜ãƒ«ãƒ‘ãƒ¼
â”‚
â”œâ”€â”€ ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â””â”€â”€ doc/
â”‚       â”œâ”€â”€ docker-compose.md        # Dockerè¨­å®šè©³ç´°
â”‚       â”œâ”€â”€ server.md                # ã‚µãƒ¼ãƒãƒ¼ç®¡ç†è©³ç´°
â”‚       â”œâ”€â”€ setup.md                 # ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—è©³ç´°
â”‚       â”œâ”€â”€ config_yml.md            # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°
â”‚       â””â”€â”€ ...                      # ãã®ä»–ã®è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚
â””â”€â”€ ğŸ“‚ ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
    â”œâ”€â”€ datasets/                    # ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸCSVãƒ•ã‚¡ã‚¤ãƒ«
    â”œâ”€â”€ OUTPUT/                      # å‡¦ç†æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿
    â””â”€â”€ logs/                        # å®Ÿè¡Œãƒ­ã‚°
```

## ğŸ“š è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### ğŸ³ ã‚¤ãƒ³ãƒ•ãƒ©ãƒ»ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | å†…å®¹ |
|------------|------|
| [doc/docker-compose.md](doc/docker-compose.md) | Qdrant Dockerè¨­å®šã¨ç®¡ç† |
| [doc/server.md](doc/server.md) | çµ±åˆã‚µãƒ¼ãƒãƒ¼ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  |
| [doc/setup.md](doc/setup.md) | ç’°å¢ƒè‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ„ãƒ¼ãƒ« |

### ğŸ“Š ãƒ‡ãƒ¼ã‚¿å‡¦ç†

| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | å†…å®¹ |
|------------|------|
| [doc/a01_load_set_rag_data.md](doc/a01_load_set_rag_data.md) | çµ±åˆRAGãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ„ãƒ¼ãƒ« |
| [doc/a02_set_vector_store_vsid.md](doc/a02_set_vector_store_vsid.md) | OpenAI Vector Storeä½œæˆè©³ç´° |

### ğŸ” æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ 

| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | å†…å®¹ |
|------------|------|
| [doc/a20_rag_search_cloud_vs.md](doc/a20_rag_search_cloud_vs.md) | ã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆRAGæ¤œç´¢è©³ç´° |
| [doc/a50_rag_search_local_qdrant.md](doc/a50_rag_search_local_qdrant.md) | ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆRAGæ¤œç´¢è©³ç´° |
| [doc/a10_show_qdrant_data.md](doc/a10_show_qdrant_data.md) | Qdrantãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºãƒ„ãƒ¼ãƒ« |
| [doc/a50_qdrant_registration.md](doc/a50_qdrant_registration.md) | Qdrantãƒ‡ãƒ¼ã‚¿ç™»éŒ²è©³ç´° |

### âš™ï¸ å…±é€šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | å†…å®¹ |
|------------|------|
| [doc/config_yml.md](doc/config_yml.md) | è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°ä»•æ§˜ |
| [doc/helper_api.md](doc/helper_api.md) | OpenAI APIãƒ©ãƒƒãƒ‘ãƒ¼è©³ç´° |
| [doc/helper_rag.md](doc/helper_rag.md) | RAGå‡¦ç†ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£è©³ç´° |
| [doc/helper_st.md](doc/helper_st.md) | Streamlitãƒ˜ãƒ«ãƒ‘ãƒ¼è©³ç´° |

## ğŸ¯ ä½¿ç”¨ä¾‹

### ä¾‹1: ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆFAQã‚·ã‚¹ãƒ†ãƒ 

```bash
# çµ±åˆãƒ„ãƒ¼ãƒ«ã§ãƒ‡ãƒ¼ã‚¿æº–å‚™
streamlit run a01_load_set_rag_data.py
# UIã§ã€Œã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆã€ã‚’é¸æŠã—ã¦å‡¦ç†

# ã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆã§å®Ÿè¡Œ
python a02_make_vsid.py
streamlit run a03_rag_search.py

# ã¾ãŸã¯ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆã§å®Ÿè¡Œ
python a50_qdrant_registration.py --domain customer
streamlit run a50_qdrant_search.py
```

### ä¾‹2: åŒ»ç™‚æƒ…å ±æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ 

```bash
# çµ±åˆãƒ„ãƒ¼ãƒ«ã§ãƒ‡ãƒ¼ã‚¿æº–å‚™
streamlit run a01_load_set_rag_data.py
# UIã§ã€ŒåŒ»ç™‚QAã€ã‚’é¸æŠã€Complex_CoTã‚’å«ã‚ã¦å‡¦ç†

# ãƒ­ãƒ¼ã‚«ãƒ«Qdrantã§æ§‹ç¯‰
python a50_qdrant_registration.py --domain medical --include-answer
streamlit run a50_qdrant_search.py
```

### ä¾‹3: ãƒãƒ«ãƒãƒ‰ãƒ¡ã‚¤ãƒ³çµ±åˆæ¤œç´¢

```bash
# çµ±åˆãƒ„ãƒ¼ãƒ«ã§å…¨ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ã‚’é †æ¬¡æº–å‚™
streamlit run a01_load_set_rag_data.py
# UIã§å„ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’é †ç•ªã«é¸æŠã—ã¦å‡¦ç†

# çµ±åˆæ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰
python a50_qdrant_registration.py --recreate
streamlit run a50_qdrant_search.py  # ALLãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’é¸æŠ
```

## âš™ï¸ è¨­å®šã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### config.yml ã®ä¸»è¦è¨­å®š

```yaml
# ãƒ¢ãƒ‡ãƒ«è¨­å®š
model:
  default: "gpt-4o-mini"
  available: ["gpt-4o", "gpt-4o-mini", "o1-preview"]

# APIè¨­å®š
api:
  timeout: 60
  max_retries: 3

# è¨€èªè¨­å®š
language:
  default: "ja"
  supported: ["ja", "en"]

# Qdrantè¨­å®š
qdrant:
  url: "http://localhost:6333"
  collection_name: "qa_corpus"
```

è©³ç´°ã¯ [doc/config_yml.md](doc/config_yml.md) ã‚’å‚ç…§

## ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### ãƒãƒƒãƒå‡¦ç†ã®æ´»ç”¨

```python
# å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®åŠ¹ç‡çš„å‡¦ç†
python a50_qdrant_registration.py --batch-size 100
```

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®åˆ©ç”¨

```python
# helper_api.py ã®MemoryCacheã‚·ã‚¹ãƒ†ãƒ ãŒè‡ªå‹•çš„ã«æœ‰åŠ¹
```

### ä¸¦åˆ—å‡¦ç†

```python
# è¤‡æ•°ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ä¸¦åˆ—å‡¦ç†
from concurrent.futures import ThreadPoolExecutor
```

## ğŸ› ï¸ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ³•

| å•é¡Œ | è§£æ±ºæ–¹æ³• |
|-----|---------|
| Qdrantã«æ¥ç¶šã§ããªã„ | `docker ps`ã§ã‚³ãƒ³ãƒ†ãƒŠçŠ¶æ…‹ã‚’ç¢ºèªã€`docker restart qdrant`ã§å†èµ·å‹• |
| OpenAI APIã‚¨ãƒ©ãƒ¼ | `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã®APIã‚­ãƒ¼ã‚’ç¢ºèªã€èª²é‡‘çŠ¶æ³ã‚’ãƒã‚§ãƒƒã‚¯ |
| ãƒ¡ãƒ¢ãƒªä¸è¶³ | `config.yml`ã§ãƒãƒƒãƒã‚µã‚¤ã‚ºã‚’èª¿æ•´ |
| æ¤œç´¢ç²¾åº¦ãŒä½ã„ | TopKå€¤ã‚’å¢—ã‚„ã™ã€embedding modelã‚’å¤‰æ›´ |

## ğŸ”„ ãƒ‡ãƒ¼ã‚¿æ›´æ–°ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

### ãƒ‡ãƒ¼ã‚¿ã®å®šæœŸæ›´æ–°

```bash
# çµ±åˆãƒ„ãƒ¼ãƒ«ã§æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
streamlit run a01_load_set_rag_data.py
# HuggingFaceã‹ã‚‰æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼†å‡¦ç†

# ãƒ™ã‚¯ãƒˆãƒ«ã‚¹ãƒˆã‚¢ã®æ›´æ–°
python a50_qdrant_registration.py --recreate
```

### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

```bash
# Qdrantãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
docker exec qdrant qdrant-backup create backup-$(date +%Y%m%d)
```

## ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶

### æœ€å°è¦ä»¶
- Python 3.8ä»¥ä¸Š
- ãƒ¡ãƒ¢ãƒª: 8GB
- ãƒ‡ã‚£ã‚¹ã‚¯: 10GB

### æ¨å¥¨è¦ä»¶
- Python 3.10ä»¥ä¸Š
- ãƒ¡ãƒ¢ãƒª: 16GBä»¥ä¸Š
- ãƒ‡ã‚£ã‚¹ã‚¯: 20GBä»¥ä¸Š
- Docker Desktopï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆä½¿ç”¨æ™‚ï¼‰

## ğŸ“ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¨è²¢çŒ®

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯RAGæŠ€è¡“ã®å®Ÿè£…ä¾‹ã¨ã—ã¦æä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚å•†ç”¨åˆ©ç”¨ã®éš›ã¯å„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

## ğŸ†˜ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆï¼š
1. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#-ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)ã‚’ç¢ºèª
2. `logs/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ç¢ºèª
3. å„æ©Ÿèƒ½ã®è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ`doc/`ï¼‰ã‚’å‚ç…§

---

**é–‹ç™ºç’°å¢ƒ**: Python 3.8+ | OpenAI API | Qdrant | Docker | Streamlit

**å¯¾å¿œãƒ¢ãƒ‡ãƒ«**: GPT-4o, GPT-4o-mini, o1-preview, o1-mini, o3-mini

**è¨€èª**: æ—¥æœ¬èªãƒ»è‹±èªå¯¾å¿œ